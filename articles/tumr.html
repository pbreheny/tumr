<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting started with the tumr package • tumr</title>
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="tumr_files/libs/quarto-html/popper.min.js"></script><script src="tumr_files/libs/quarto-html/tippy.umd.min.js"></script><link href="tumr_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="tumr_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Getting started with the tumr package">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tumr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/tumr.html">Get started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/data.html">tumr data sets</a></li>
    <li><a class="dropdown-item" href="../articles/troubleshooting.html">Troubleshooting</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pbreheny/tumr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Getting started with the tumr package</h1>




      <small class="dont-index">Source: <a href="https://github.com/pbreheny/tumr/blob/main/vignettes/tumr.qmd" class="external-link"><code>vignettes/tumr.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <p>In this guide, we demonstrate the core functionality of the tumr package using the melanoma2 dataset included with the package. All code required to reproduce the examples is provided below.</p>
<section class="section level2"><h2 id="loading-the-data">Loading the Data<a class="anchor" aria-label="anchor" href="#loading-the-data"></a>
</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pbreheny.github.io/tumr/">tumr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"melanoma2"</span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="section level2"><h2 id="a-naive-mean-based-visualization">A Naive Mean-Based Visualization<a class="anchor" aria-label="anchor" href="#a-naive-mean-based-visualization"></a>
</h2>
<p>Before introducing tumr functionality, we first construct a simple plotting function to illustrate a common pitfall in tumor growth visualization.</p>
<section class="level4"><h5 id="code-for-plot_mean">Code for plot_mean()<a class="anchor" aria-label="anchor" href="#code-for-plot_mean"></a>
</h5>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_mean</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">group</span>, <span class="va">time</span>, <span class="va">measure</span>, <span class="va">id</span>, <span class="va">stat</span> <span class="op">=</span> <span class="va">median</span>, <span class="va">remove_na</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">data_summary</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="op">{</span><span class="op">{</span><span class="va">group</span><span class="op">}</span><span class="op">}</span>, <span class="op">{</span><span class="op">{</span><span class="va">time</span><span class="op">}</span><span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>measure <span class="op">=</span> <span class="fu">stat</span><span class="op">(</span><span class="op">{</span><span class="op">{</span><span class="va">measure</span><span class="op">}</span><span class="op">}</span>, na.rm <span class="op">=</span> <span class="va">remove_na</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop_last"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">remove_na</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">data_full</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">data_full</span> <span class="op">&lt;-</span> <span class="va">data</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_full</span>,</span>
<span>                       <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">{</span><span class="op">{</span><span class="va">time</span><span class="op">}</span><span class="op">}</span>,</span>
<span>                                    y <span class="op">=</span> <span class="op">{</span><span class="op">{</span><span class="va">measure</span><span class="op">}</span><span class="op">}</span>,</span>
<span>                                    group <span class="op">=</span> <span class="op">{</span><span class="op">{</span><span class="va">id</span><span class="op">}</span><span class="op">}</span>,</span>
<span>                                    color <span class="op">=</span> <span class="op">{</span><span class="op">{</span><span class="va">group</span><span class="op">}</span><span class="op">}</span><span class="op">)</span>,</span>
<span>                       alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>  <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_summary</span>,</span>
<span>                       <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">{</span><span class="op">{</span><span class="va">time</span><span class="op">}</span><span class="op">}</span>,</span>
<span>                                    y <span class="op">=</span> <span class="va">measure</span>,</span>
<span>                                    color <span class="op">=</span> <span class="op">{</span><span class="op">{</span><span class="va">group</span><span class="op">}</span><span class="op">}</span><span class="op">)</span>,</span>
<span>                       linewidth <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>            y <span class="op">=</span> <span class="st">"Volume"</span>,</span>
<span>            title <span class="op">=</span> <span class="st">"Volume over Time"</span></span>
<span>          <span class="op">)</span></span>
<span></span>
<span><span class="op">}</span></span></code></pre></div>
</details>
</div>
<p><strong>Note:</strong> plot_mean() is not part of the tumr package. It is defined here solely to provide a baseline visualization for comparison with tumr’s methods.</p>
</section></section><section class="section level2"><h2 id="creating-a-tumr-object">Creating a tumr Object<a class="anchor" aria-label="anchor" href="#creating-a-tumr-object"></a>
</h2>
<p>Most tumr functions operate on a tumr object, which stores both the data and its associated metadata (subject ID, time, outcome, and grouping variable).</p>
<p>To create a tumr object, use the tumr() function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mel2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tumr.html">tumr</a></span><span class="op">(</span><span class="va">melanoma2</span>, <span class="va">ID</span>, <span class="va">Day</span>, <span class="va">Volume</span>, <span class="va">Treatment</span><span class="op">)</span></span></code></pre></div>
</div>
<p>This object can now be passed directly into other tumr functions.</p>
</section><section class="section level2"><h2 id="visualizing-tumor-growth">Visualizing Tumor Growth<a class="anchor" aria-label="anchor" href="#visualizing-tumor-growth"></a>
</h2>
<p>The figure below compares a naive longitudinal visualization with a tumr-based approach that explicitly accounts for censoring and missing observations.</p>
<div class="sourceCode cell-code" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot_mean</span><span class="op">(</span><span class="va">melanoma2</span>, <span class="va">Treatment</span>, <span class="va">Day</span>, <span class="va">Volume</span>, <span class="va">ID</span>, stat <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_median.html">plot_median</a></span><span class="op">(</span><span class="va">mel2</span><span class="op">)</span></span></code></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="tumr_files/figure-html/unnamed-chunk-4-1.png" width="384"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="tumr_files/figure-html/unnamed-chunk-4-2.png" width="384"></p>
</div>
</div>
</div>
<p>The plot on the left uses a straightforward summary of observed data at each time point. This approach ignores the structure of missingness common in tumor growth studies, where subjects frequently leave the study due to censoring or dropout. As a result, the apparent decline in tumor volume over time is an artifact of estimating summaries from a progressively smaller subset of subjects rather than a true biological effect.</p>
<p>The visualization produced by plot_median() addresses these issues through an explicit preprocessing step designed for longitudinal tumor data.</p>
<p>Before any summary statistic is computed, the function:</p>
<ol type="1">
<li>
<strong>Aligns time points across subjects</strong> Rows are added for unobserved time points so that all subjects share a common time grid.</li>
<li>
<strong>Handles trailing missing values due to censoring</strong> The last observed value is carried forward and marked with a “+” to indicate right-censoring.</li>
</ol>
<ul>
<li>Example: 3, 6, 9, NA → 3, 6, 9, 9+</li>
</ul>
<ol start="3" type="1">
<li>
<strong>Interpolates embedded missing values</strong> Missing observations that occur between recorded time points are interpolated to preserve trajectory continuity.</li>
</ol>
<p>After preprocessing, tumor volume summaries are computed at each time point within each treatment group using a Kaplan–Meier–based approach. This strategy ensures that summaries reflect both observed data and informative missingness, producing a visualization that more accurately represents tumor growth dynamics over time.</p>
</section><section class="section level2"><h2 id="response-feature-analysis">Response feature analysis<a class="anchor" aria-label="anchor" href="#response-feature-analysis"></a>
</h2>
<p>One of the primary analysis tools in tumr is the rfeat() function, which implements response feature analysis. This two-stage approach simplifies complex longitudinal data by extracting a single interpretable summary measure per subject.</p>
<p>Specifically, rfeat():</p>
<ol type="1">
<li><p>Computes a growth slope (beta coefficient) for each subject</p></li>
<li><p>Averages these slopes within each treatment group</p></li>
<li>
<p>Compares group-level summaries using one of the following methods:</p>
<ul>
<li>t-test</li>
<li>ANOVA</li>
<li>Tukey post-hoc test</li>
<li>Both ANOVA and Tukey post-hoc tests</li>
</ul>
</li>
</ol>
<p>The example below uses comparison = “both” to perform ANOVA followed by Tukey post-hoc comparisons.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">rfeat_mel2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rfeat.html">rfeat</a></span><span class="op">(</span><span class="va">mel2</span>, comparison <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$anova
            Df   Sum Sq   Mean Sq F value Pr(&gt;F)
Group        4 0.008424 0.0021061   2.938 0.0314 *
Residuals   42 0.030106 0.0007168
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

$tukey
  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = Beta ~ Group, data = betas)

$Group
            diff         lwr          upr     p adj
B-A -0.039562710 -0.07461937 -0.004506050 0.0200139
C-A -0.027355317 -0.06147696  0.006766330 0.1701000
D-A -0.023685320 -0.05780697  0.010436327 0.2941216
E-A -0.030852007 -0.06704348  0.005339465 0.1274422
C-B  0.012207393 -0.02284927  0.047264052 0.8572838
D-B  0.015877390 -0.01917927  0.050934049 0.6982531
E-B  0.008710703 -0.02836362  0.045785023 0.9618601
D-C  0.003669997 -0.03045165  0.037791644 0.9980027
E-C -0.003496690 -0.03968816  0.032694782 0.9986875
E-D -0.007166687 -0.04335816  0.029024785 0.9794890</code></pre>
</div>
</div>
<section class="level2"><h3 id="plotting-response-feature-results">Plotting Response Feature Results<a class="anchor" aria-label="anchor" href="#plotting-response-feature-results"></a>
</h3>
<p>The plot() method for rfeat objects displays both the individual subject slopes and the group-level means.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rfeat_mel2</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="tumr_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section class="section level2"><h2 id="linear-mixed-model">Linear mixed model<a class="anchor" aria-label="anchor" href="#linear-mixed-model"></a>
</h2>
<p>The tumr package also includes lmm(), which fits a linear mixed effects model to tumor growth data. Linear mixed models are well suited for longitudinal data because they account for:</p>
<ul>
<li>Fixed effects: population-level effects of interest (e.g., treatment, time)</li>
<li>Random effects: subject-specific variability that induces correlation among repeated measurements</li>
</ul>
<p>By default, lmm() fits the model:</p>
<div class="text-center">
<p><code>log1p(measure) ~ group * time + (time | id)</code></p>
</div>
<p>This specification allows each subject to have their own growth trajectory while estimating overall treatment effects. The model formula can be customized if desired.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">lmm_mel2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lmm.html">lmm</a></span><span class="op">(</span><span class="va">mel2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.00566844 (tol = 0.002, component 1)
  See ?lme4::convergence and ?lme4::troubleshooting.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: log1p(Volume) ~ Treatment * Day + (Day | ID)
   Data: data

REML criterion at convergence: 1216.5

Scaled residuals:
    Min      1Q  Median      3Q     Max
-6.8683 -0.3590  0.0569  0.4891  4.0759

Random effects:
 Groups   Name        Variance  Std.Dev. Corr
 ID       (Intercept) 0.3909753 0.62528
          Day         0.0006511 0.02552  -0.51
 Residual             0.3220706 0.56751
Number of obs: 568, groups:  ID, 47

Fixed effects:
               Estimate Std. Error       df t value Pr(&gt;|t|)
(Intercept)     3.66092    0.22688 46.83127  16.136  &lt; 2e-16 ***
TreatmentB      0.53834    0.32255 42.89746   1.669  0.10240
TreatmentC      0.78053    0.31957 46.08359   2.442  0.01848 *
TreatmentD      1.33290    0.32410 48.71755   4.113  0.00015 ***
TreatmentE     -0.14693    0.33197 42.42209  -0.443  0.66031
Day             0.07971    0.00897 47.89633   8.886 1.06e-11 ***
TreatmentB:Day -0.03972    0.01269 43.36203  -3.130  0.00312 **
TreatmentC:Day -0.02673    0.01255 46.24553  -2.129  0.03859 *
TreatmentD:Day -0.02497    0.01321 54.20921  -1.890  0.06410 .
TreatmentE:Day -0.03060    0.01300 42.19464  -2.355  0.02325 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) TrtmnB TrtmnC TrtmnD TrtmnE Day    TrtB:D TrtC:D TrtD:D
TreatmentB  -0.703
TreatmentC  -0.710  0.499
TreatmentD  -0.700  0.492  0.497
TreatmentE  -0.683  0.481  0.485  0.478
Day         -0.577  0.406  0.410  0.404  0.394
TretmntB:Dy  0.408 -0.560 -0.290 -0.286 -0.279 -0.707
TretmntC:Dy  0.412 -0.290 -0.573 -0.289 -0.282 -0.715  0.505
TretmntD:Dy  0.392 -0.276 -0.278 -0.585 -0.268 -0.679  0.480  0.485
TretmntE:Dy  0.398 -0.280 -0.283 -0.279 -0.556 -0.690  0.488  0.493  0.469
optimizer (nloptwrap) convergence code: 0 (OK)
Model failed to converge with max|grad| = 0.00566844 (tol = 0.002, component 1)
  See ?lme4::convergence and ?lme4::troubleshooting.</code></pre>
</div>
</div>
<p><strong>Note:</strong> You may see a convergence warning when fitting this model. If this occurs, see the <a href="articles/troubleshooting.html">Troubleshooting</a> article for guidance.</p>
<section class="level2"><h3 id="summarizing-linear-mixed-model-results">Summarizing Linear Mixed Model Results<a class="anchor" aria-label="anchor" href="#summarizing-linear-mixed-model-results"></a>
</h3>
<p>The summary() method for lmm objects uses the emmeans package to report:</p>
<ul>
<li>The overall effect of time</li>
<li>Treatment-specific slopes over time</li>
<li>Statistical tests comparing slope differences between groups</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lmm_mel2</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`overall effect of time`
 1       Day.trend      SE   df lower.CL upper.CL
 overall    0.0553 0.00411 41.3    0.047   0.0636

Results are averaged over the levels of: Treatment
Degrees-of-freedom method: kenward-roger
Confidence level used: 0.95

$`slope of treatment over time`
 Treatment Day.trend      SE   df lower.CL upper.CL
 A            0.0797 0.00898 43.6   0.0616   0.0978
 B            0.0400 0.00898 35.8   0.0218   0.0582
 C            0.0530 0.00879 40.6   0.0352   0.0707
 D            0.0547 0.00972 55.4   0.0353   0.0742
 E            0.0491 0.00941 34.4   0.0300   0.0682

Degrees-of-freedom method: kenward-roger
Confidence level used: 0.95

$`test slope differences`
 contrast estimate     SE   df t.ratio p.value
 A - B     0.03972 0.0127 39.4   3.128  0.0258
 A - C     0.02673 0.0126 42.1   2.128  0.2277
 A - D     0.02497 0.0132 49.4   1.887  0.3378
 A - E     0.03060 0.0130 38.4   2.354  0.1505
 B - C    -0.01300 0.0126 38.0  -1.034  0.8378
 B - D    -0.01476 0.0132 44.8  -1.115  0.7977
 B - E    -0.00912 0.0130 35.0  -0.701  0.9548
 C - D    -0.00176 0.0131 47.9  -0.134  0.9999
 C - E     0.00388 0.0129 37.0   0.301  0.9981
 D - E     0.00564 0.0135 43.4   0.417  0.9934

Degrees-of-freedom method: kenward-roger
P value adjustment: tukey method for comparing a family of 5 estimates </code></pre>
</div>
</div>
</section><section class="level2"><h3 id="plotting-linear-mixed-model-results">Plotting Linear Mixed Model Results<a class="anchor" aria-label="anchor" href="#plotting-linear-mixed-model-results"></a>
</h3>
<p>Finally, tumr provides a plot() method for lmm objects that produces two visualizations:</p>
<ol type="1">
<li>Predicted tumor growth trajectories over time</li>
<li>Estimated mean growth slopes for each group with confidence intervals</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lmm_mel2</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Model has log1p-transformed response. Back-transforming predictions to
  original response scale. Standard errors are still on the transformed
  scale.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$predicted_measure</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure><p><img src="tumr_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$mean_betas</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure><p><img src="tumr_files/figure-html/unnamed-chunk-9-2.png" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Patrick Breheny, Sydney Plowman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Last updated: February 11, 2026</p>
</div>

    </footer>
</div>





  </body>
</html>
