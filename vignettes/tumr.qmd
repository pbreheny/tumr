---
title: "Getting started with the tumr package"
vignette: >
  %\VignetteIndexEntry{Quarto HTML Vignettes}
  %\VignetteEngine{quarto::html}
  %\VignetteEncoding{UTF-8}
---

We should write a brief intro here for one of the data sets.

## melanoma2 data set

```{r}
library(tumr)
data("melanoma2")
```

```{r}
plot_mean <- function(data, group, time, measure, id, stat = median, remove_na = FALSE){
  data_summary <- data |>
    dplyr::group_by({{group}}, {{time}}) |>
    dplyr::summarise(measure = stat({{measure}}, na.rm = remove_na), .groups = "drop_last") |>
    dplyr::ungroup()

  if (remove_na == TRUE){
    data_full <- data |>
      na.omit(data)
  } else {
    data_full <- data
  }

  ggplot2::ggplot() +
    ggplot2::geom_line(data = data_full,
                       ggplot2::aes(x = {{time}},
                                    y = {{measure}},
                                    group = {{id}},
                                    color = {{group}}),
                       alpha = 0.5)  +
    ggplot2::geom_line(data = data_summary,
                       ggplot2::aes(x = {{time}},
                                    y = measure,
                                    color = {{group}}),
                       linewidth = 1.2)

}
```

## Plotting the Mean vs the Median

```{r, fig.show='hold', out.width='50%'}
meta_data <- tumr(melanoma2, ID, Day, Volume, Treatment)
plot_mean(melanoma2, Treatment, Day, Volume, ID, stat = mean)
meta_data |>
  plot_median()
```

## Response Feature Analysis of melanoma2

```{r}
(rfeat_ex <- meta_data |>
              rfeat(comparison = "both"))
```


## rfeat plot

```{r}
plot(rfeat_ex)
```


## Linear mixed model

```{r}
(example <- meta_data |>
  lmm())

#emmeans(example, c("Treatment", "Day"))
```


